<div class="flex flex-col sm:flex-row justify-between items-center mb-8">
    <h1 class="text-3xl font-bold text-gray-800">Crop Management</h1>
    <a routerLink="/admin/add" class="bg-green-600 text-white font-bold py-2 px-5 rounded-lg hover:bg-green-700 flex items-center shadow-md">
        <svg class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>
        Add New Crop
    </a>
</div>

<div class="bg-white rounded-xl shadow-lg overflow-hidden">
    <div class="overflow-x-auto">
        <table class="min-w-full">
            <thead class="bg-gray-50 border-b border-gray-200">
                <tr>
                    <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">
                        Crop Name
                    </th>
                    <th scope="col" class="px-6 py-4 text-left text-xs font-semibold text-gray-500 uppercase tracking-wider">
                        Sowing Season
                    </th>
                    <th scope="col" class="px-6 py-4 text-center text-xs font-semibold text-gray-500 uppercase tracking-wider">
                        Actions
                    </th>
                </tr>
            </thead>
            <tbody class="divide-y divide-gray-200">
                <!-- 1. Show loading indicator while fetching data -->
                <tr *ngIf="isLoading">
                    <td colspan="3" class="px-6 py-12 text-center text-gray-500">
                        Loading crop data...
                    </td>
                </tr>

                <!-- 2. Loop through crops once data is loaded -->
                <tr *ngFor="let crop of crops" class="hover:bg-gray-50">
                    <td class="p-4 font-medium text-gray-800">{{ crop.name }}</td>
                    <td class="p-4 text-gray-600">{{ crop.sowingSeason || 'N/A' }}</td>
                    <td class="p-4 text-center space-x-4">
                        <a [routerLink]="['/crops', crop._id]" target="_top" class="text-green-600 font-semibold">View</a>
                        <a [routerLink]="['/admin/edit', crop._id]" class="text-blue-600 font-semibold">Edit</a>
                        <button (click)="deleteCrop(crop._id)" class="delete-btn text-red-600 font-semibold">Delete</button>
                    </td>
                </tr>
                
                <!-- 3. Show "No crops found" message only after loading is complete and if crops array is empty -->
                <tr *ngIf="!isLoading && crops.length === 0">
                    <td colspan="3" class="px-6 py-12 text-center text-gray-500">
                        No crops found. Click "+ Add New Crop" to add one.
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>